# UV Setup Guide

This project is configured to use **UV**, a fast and reliable Python package manager.

## Quick Start

### 1. Install UV (if needed)

UV is often bundled with Python, but if you need to install it:

```bash
# macOS/Linux
curl -LsSf https://astral.sh/uv/install.sh | sh

# Windows (with PowerShell)
powershell -ExecutionPolicy BypassUser -c "irm https://astral.sh/uv/install.ps1 | iex"

# Or with pip
pip install uv
```

Verify installation:
```bash
uv --version
```

### 2. Create Virtual Environment and Install Dependencies

```bash
cd dissertation-analysis
uv sync
```

This single command:
- Creates a `.venv/` virtual environment
- Reads `pyproject.toml` and `uv.lock`
- Installs all dependencies (10-100x faster than pip)
- Ensures reproducible environment

### 3. Activate Virtual Environment

**macOS/Linux:**
```bash
source .venv/bin/activate
```

**Windows (Command Prompt):**
```bash
.venv\Scripts\activate
```

**Windows (PowerShell):**
```bash
.venv\Scripts\Activate.ps1
```

### 4. Run the Project

```bash
# Run complete pipeline
python run_all.py

# Or run individual notebooks
python Notebooks/01_descriptive_statistics.py
python Notebooks/02_essay2_event_study.py
python Notebooks/03_essay3_information_asymmetry.py
python Notebooks/04_enrichment_analysis.py

# Or run dashboard
streamlit run Dashboard/app.py
```

## UV vs Pip Comparison

| Task | UV | Pip |
|------|-----|-----|
| Create venv + install deps | `uv sync` | `python -m venv venv && pip install -r requirements.txt` |
| Speed | üöÄ 10-100x faster | ‚è≥ Slower |
| Add package | `uv pip install pandas` | `pip install pandas && pip freeze > requirements.txt` |
| Update all | `uv lock --upgrade` | Manual |
| Reproducibility | ‚úÖ Locked versions (uv.lock) | ‚ö†Ô∏è Floating versions |

## Key Files

- **pyproject.toml** - Project definition and dependencies
  - Contains all package requirements
  - Project metadata (name, version, author, etc.)
  - Tool configurations (black, ruff, etc.)

- **uv.lock** - Locked dependency versions
  - Guarantees reproducible installs
  - Generated by `uv lock` or `uv sync`
  - Don't manually edit - let UV manage it

- **requirements.txt** - Fallback for pip
  - Simple format for basic pip usage
  - Maintained for backward compatibility

## Common Commands

```bash
# Sync environment (install/update)
uv sync

# Add a new package
uv pip install package-name

# Update all packages to latest
uv lock --upgrade

# Show installed packages
uv pip list

# Run Python script with UV environment
uv run python script.py

# Deactivate environment
deactivate
```

## Troubleshooting

### "uv command not found"

Make sure UV is installed:
```bash
curl -LsSf https://astral.sh/uv/install.sh | sh
```

Then add to PATH or use:
```bash
python -m pip install uv
```

### "ModuleNotFoundError" when running scripts

Ensure virtual environment is activated:
```bash
# Check if activated (should show (.venv) in prompt)
source .venv/bin/activate  # macOS/Linux
.venv\Scripts\activate      # Windows

# Verify Python is from venv
which python  # macOS/Linux: should show .venv/bin/python
where python  # Windows: should show .venv\Scripts\python.exe
```

### Regenerate lock file

If you modify `pyproject.toml`:
```bash
uv lock
uv sync
```

### Use specific Python version

```bash
uv venv --python 3.11
uv sync
```

## Benefits for Reproduction

This project uses UV + `uv.lock` for **100% reproducible environments**:

1. **Same versions everywhere** - `uv.lock` specifies exact versions
2. **Fast setup** - `uv sync` in seconds, not minutes
3. **No conflicts** - UV resolves dependencies correctly
4. **Works across systems** - Windows, macOS, Linux all supported
5. **Committee verification** - Anyone can reproduce results exactly

## For Committee Members

If you need to verify the analysis:

```bash
# Clone repo
git clone [repo-url]
cd dissertation-analysis

# Copy Data/ from shared folder (see README.md)

# Install with one command
uv sync

# Activate
source .venv/bin/activate  # or .venv\Scripts\activate on Windows

# Run
python run_all.py
```

All outputs will be identical to the original analysis.

## Resources

- [UV Documentation](https://docs.astral.sh/uv/)
- [Python Packaging Guide](https://packaging.python.org/)
- [PEP 517: Build System Interface](https://www.python.org/dev/peps/pep-0517/)
